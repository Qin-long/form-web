# 拖拽式表单设计器使用说明

## 概述

拖拽式表单设计器是一个基于 React + TypeScript + Ant Design 的可视化表单设计工具，支持通过拖拽方式设计表单，并支持配置保存、导入导出等功能。

## 功能特性

### 核心功能
- **拖拽设计**: 从组件库拖拽组件到设计画布
- **实时预览**: 设计完成后可实时预览表单效果
- **配置保存**: 支持保存设计配置到本地存储
- **导入导出**: 支持配置文件的导入和导出
- **属性配置**: 选中组件后可配置其属性和校验规则

### 支持的组件类型

#### 基础组件
- **输入框**: 单行文本输入
- **多行输入框**: 多行文本输入
- **单选框**: 单选选项
- **多选框**: 多选选项
- **下拉选择**: 下拉菜单选择
- **日期选择**: 日期选择器
- **时间选择**: 时间选择器
- **评分**: 星级评分
- **图片上传**: 文件上传

#### 高级组件
- **姓名**: 中文姓名输入（带校验）
- **手机号**: 手机号输入（带校验）
- **身份证**: 身份证号输入（带校验）
- **邮箱**: 邮箱输入（带校验）
- **年龄**: 年龄输入（带校验）
- **省份**: 省份下拉选择
- **民族**: 民族选择
- **政治面貌**: 政治面貌选择

## 使用方法

### 1. 开始设计

1. 打开应用后，默认进入设计模式
2. 左侧是组件库，分为"基础组件"和"高级组件"两个标签页
3. 中间是设计画布，用于放置和排列组件
4. 右侧是属性面板，用于配置选中组件的属性

### 2. 添加组件

1. 从左侧组件库中拖拽需要的组件到设计画布
2. 组件会自动添加到画布中，并自动选中
3. 可以在右侧属性面板中配置组件的属性

### 3. 配置组件

选中组件后，在右侧属性面板中可以配置：

#### 基础属性
- **字段名称**: 组件的唯一标识
- **显示标签**: 组件显示的标签文字
- **占位符**: 输入框的占位符文字
- **宽度**: 组件的宽度（像素）
- **高度**: 多行输入框的行数

#### 校验规则
- **必填**: 是否必填
- **最小长度**: 最小字符数
- **最大长度**: 最大字符数
- **错误提示**: 自定义错误提示信息

#### 特殊配置
- **评分组件**: 最大分值、是否允许半星
- **上传组件**: 接受文件类型、最大文件大小、最大上传数量

### 4. 预览表单

1. 点击顶部的"预览"标签页
2. 可以查看设计好的表单效果
3. 可以填写表单并测试提交功能

### 5. 保存配置

1. 点击工具栏的"保存配置"按钮
2. 输入配置名称
3. 配置会保存到浏览器的本地存储中

### 6. 导出配置

1. 点击工具栏的"导出配置"按钮
2. 会自动下载一个 JSON 文件
3. 文件包含完整的表单配置信息

### 7. 导入配置

1. 点击工具栏的"导入配置"按钮
2. 选择之前导出的 JSON 文件
3. 配置会自动加载到设计器中

## 配置格式

导出的配置文件格式如下：

```json
{
  "title": "表单标题",
  "fields": [
    {
      "type": "input",
      "name": "field1",
      "label": "字段标签",
      "placeholder": "占位符",
      "width": 300,
      "validation": {
        "required": true,
        "min": 2,
        "max": 50
      }
    }
  ],
  "layout": "vertical",
  "responsive": true
}
```

## 技术实现

### 核心组件

- **ComponentPanel**: 组件库面板，显示可拖拽的组件
- **DesignCanvas**: 设计画布，支持拖拽放置和组件管理
- **PropertyPanel**: 属性面板，用于配置组件属性
- **FormDesigner**: 主设计器，整合所有功能

### 数据流

1. 组件库定义 → 拖拽到画布 → 生成字段实例
2. 选中字段 → 属性面板配置 → 更新字段属性
3. 字段集合 → 生成表单配置 → 保存/导出

### 状态管理

- 使用 React Hooks 管理组件状态
- 字段数据存储在 `fields` 状态中
- 选中状态存储在 `selectedFieldId` 中

## 扩展开发

### 添加新组件

1. 在 `src/data/componentLibrary.ts` 中添加组件定义
2. 在 `src/components/FormField.tsx` 中添加渲染逻辑
3. 在 `src/components/PropertyPanel.tsx` 中添加配置项

### 自定义校验规则

1. 在 `src/utils/validation.ts` 中添加校验函数
2. 在 `customValidators` 中注册校验规则
3. 在属性面板中添加校验配置项

## 最佳实践

1. **组件命名**: 使用有意义的字段名称
2. **布局设计**: 合理排列组件，保持界面整洁
3. **校验配置**: 根据业务需求设置合适的校验规则
4. **配置保存**: 定期保存设计配置，避免数据丢失
5. **测试验证**: 设计完成后及时预览和测试

## 常见问题

### Q: 如何调整组件位置？
A: 目前组件位置是自动排列的，后续版本会支持手动拖拽调整位置。

### Q: 如何删除组件？
A: 选中组件后，点击组件右上角的删除按钮即可删除。

### Q: 配置保存在哪里？
A: 配置保存在浏览器的 localStorage 中，清除浏览器数据会导致配置丢失。

### Q: 如何分享表单配置？
A: 可以导出配置文件，然后分享给其他人导入使用。 